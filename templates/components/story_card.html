<div class="story-card {% if not story.image_url %}no-image{% endif %}" 
     id="story-{{ story.id }}"
     onclick="location.href='{{ url_for('story_detail', story_id=story.id) }}'"
     style="cursor: pointer;">
    
    <div class="story-header">
        <div class="story-author">
            {% if story.is_anonymous %}
            <span class="author-name">Anonymous</span>
            {% else %}
            <span class="author-name">{{ story.author.username }}</span>
            {% endif %}
            <span class="story-time">{{ story.created_at.strftime('%d %b %Y %H:%M') }}</span>
        </div>
        {% if current_user.is_authenticated and current_user.id == story.user_id %}
        <form action="{{ url_for('delete_story', story_id=story.id) }}" method="POST" class="delete-form" onclick="event.stopPropagation()">
            <button type="submit" class="btn-delete" onclick="return confirm('Hapus curhatan ini?')">
                <i class="fas fa-trash"></i>
            </button>
        </form>
        {% endif %}
    </div>
    
    <div class="story-content-side">
        {% if story.image_url %}
        <div class="story-image-side" onclick="event.stopPropagation(); openStoryImage('{{ story.id }}')" style="cursor: zoom-in;">
            <img src="{{ url_for('static', filename=story.image_url) }}" 
                 alt="Story image" 
                 loading="lazy">
            <div class="image-overlay">
                <i class="fas fa-expand"></i>
            </div>
        </div>
        {% endif %}
        
        <div class="story-text">
            {{ story.content }}
        </div>
        
        <div class="story-actions-side">
            <div class="action-item">
                {% if current_user.is_authenticated %}
                <button class="btn-like {% if story.user_has_liked %}liked{% endif %}" 
                        data-story-id="{{ story.id }}"
                        onclick="event.stopPropagation(); likeStory({{ story.id }}, this)">
                    <i class="fas fa-heart"></i>
                    <span class="like-count">{{ story.likes|length }}</span>
                </button>
                {% else %}
                <button class="btn-like" onclick="event.stopPropagation(); window.location.href='{{ url_for('login') }}'">
                    <i class="fas fa-heart"></i>
                    <span class="like-count">{{ story.likes|length }}</span>
                </button>
                {% endif %}
            </div>
            
            <a href="{{ url_for('story_detail', story_id=story.id) }}" class="action-item" onclick="event.stopPropagation()">
                <i class="fas fa-comment"></i>
                <span class="comment-count">{{ story.comments|length }}</span>
            </a>
        </div>
    </div>
</div>